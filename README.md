# フリースクールでの出席管理システム

## プロジェクト概要

**フリースクールの出席管理業務を自動化したPythonデスクトップアプリケーション**

教育現場では，出席管理は2つの側面を兼ねています。
1．出席の確認
2．児童生徒の健康観察
一般的な教室では，全員が一斉に朝の会そろいますが、フリースクールなどの民間の教育機関では、だれが、いつ来て、帰ったかを手作業で記録、入力することは非常に煩雑な処理でした。そこで、出席管理と健康観察の両側面を満たすアプリケーションを開発し、塾へ導入しました。**3万円の開発報酬と月3000円の運営費**を契約した、システムです。4月下旬から約3ヶ月の個人開発により、現在も継続運用されています。

## 解決した課題

### 従来の問題点
フリースクールでは生徒の来校・帰宅時間が不定期で、従来の手作業による出席管理では以下の問題が頻発していました：

1. **出席時の記録漏れ** - 不規則な来校タイミングでの記録忘れ、漏れ
2. **転記漏れ・転記間違い** - 手書きからデジタルへの移行時のヒューマンエラー  
3. **月末締めのデータ取り違い** - 集計作業での混乱
4. **健康観察との二重管理** - 出席記録と心理状態把握の非効率性

### 解決効果
- **記録ミスの完全排除** - 学生証にQRコードを貼り付けし、スキャナーで読み取ることによって自動で記録します
- **作業時間の大幅短縮** - コピー＆ペーストで行っていた月次レポート作成作業をクリックで完結するようにしました
- **生徒の心理状態の可視化** - 出席時、子どもは3つの質問に回答します。これは名簿に記録され、教師は簡単に状態を振り返ることができます。

## 主な機能

- **QRコード出席記録**: 生徒がQRコードをかざすだけで入退室時刻を自動記録
- **心理状態モニタリング**: 出席時に3つの質問（気分、睡眠状態、来校の目的）で生徒の心理状態を記録・可視化
- **シンプルなデータ管理**: 生徒情報はCSVファイル（`assets/sample_data.csv`）で管理
- **QRコードラベル印刷**: Brother P-touch Editorと連携して、生徒用のQRコードラベルを印刷する機能をアプリケーションに導入  
- **出席レポート作成**: 月ごとの出席状況をPDFやExcel形式で出力

## 開発で工夫した点

### 1. ユーザビリティ重視の設計
- **優しい色合いのUI**: 教育現場に適したリラックスできる色調を採用
- **直感的操作**: 心理状態の回答に画像を使用し、ビジュアライゼーションで分かりやすく
- **エラーの起きにくいシンプルロジック**: 複雑な処理を避け、安定性を重視

### 2. 段階的開発手法
- **最小要件からスタート**: 基本機能から段階的に機能拡張
- **継続的テスト**: 安定動作のため繰り返しテストを実施
- **要件定義の丁寧なすり合わせ**: 事業主とのイメージ共有とフィードバック反映

### 3. スケーラブルな設計思想
- **外部サービス非依存**: メンテナンス性を高め、他施設への展開を考慮
- **ローカルファイル管理**: 導入コストを抑制し、データセキュリティを確保

## ファイル構成

```
attendance-management-system/
├── AttendanceManagement.exe     # メインアプリケーション（PyInstallerで作成）
├── README.md                    # このファイル
├── settings.json               # 設定ファイル
├── service_account.json.template # Google認証テンプレート（必要に応じて）
├── start_app.py                # 開発用起動スクリプト
├── assets/                     # アセットファイル
│   ├── fonts/                  # フォントファイル
│   ├── images/                 # 画像ファイル
│   ├── sounds/                 # 音声ファイル
│   ├── sample_data.csv         # 生徒データ（要編集）
│   └── Sample_Data.xlsx        # Excelファイル形式の生徒データ
├── output/                     # 出力フォルダ
│   └── reports/               # レポート保存先
├── docs/                      # ドキュメント
└── dist-src/                  # 配布用ソースコード
    ├── requirements.txt
    ├── attendance_app.spec    # PyInstaller設定
    └── src/                   # Pythonソースコード
```

## 使い方

### すぐに試したい場合

1. **生徒データを準備**
   - `assets/sample_data.csv` を開いて編集
   - 実際の生徒ID・名前に変更
   ```csv
   StudentID,StudentName
   2025001,山田太郎
   2025002,鈴木花子
   ```

2. **アプリを起動**
   - `AttendanceManagement.exe` をダブルクリック

### 開発者の方へ

1. **Python環境の準備**
   ```bash
   pip install -r dist-src/requirements.txt
   ```

2. **ソースコードから実行**
   ```bash
   python start_app.py
   ```

## 操作の流れ

1. **出席記録**: QRコードをスキャンするか、生徒IDを手入力して入退室を記録
2. **ラベル印刷**: 印刷画面で生徒を選んでQRコードラベルを作成
3. **レポート確認**: 月を指定して出席状況をPDFやExcelで出力

## 動作環境

- **OS**: Windows 10/11
- **プリンター**: Brother P-touch Editor（QRコード印刷する場合）
- **開発用**: Python 3.9以降

## トラブル時は

問題が発生した場合は、`docs/` フォルダ内の詳しい説明を参考にしてください。

## 技術スタック

### 言語・フレームワーク
- **Python 3.9+**: メイン開発言語
- **Kivy**: GUIフレームワーク（初回デスクトップアプリ開発での学習・選択）
- **PyInstaller**: 実行ファイル化（配布用exe作成）

### 主要ライブラリ
- **openpyxl**: CSV/Excelファイルの読み書き処理
- **ReportLab**: 出席レポートのPDF生成
- **PIL/Pillow**: QRコード生成・画像処理
- **JSON**: 設定ファイル管理

### 技術選択の理由
- **Kivy採用**: 初回アプリ開発で最も手軽に感じたPythonベースのGUIフレームワーク
- **外部サービス非依存**: 他施設への展開を見越したメンテナンス性重視の設計
- **CSV/ローカルファイル**: 導入コストとデータセキュリティの両立

## 開発実績・成果

### プロジェクト規模
- **開発期間**: 2024年4月下旬〜7月22日（約3ヶ月）
- **開発体制**: 個人開発（コーディング担当）
- **ビジネス成果**: 初期報酬3万円 + 継続運営費月3000円

### 開発プロセス
- **要件定義**: 事業主との継続的なイメージすり合わせ
- **アジャイル開発**: テストタイプ導入によるフィードバックループ
- **品質管理**: 繰り返しテストによる安定性確保

### 運用実績
- **継続運用中**: 2024年7月導入後、現在も安定稼働
- **スケーラビリティ**: 他スクールへの展開を見据えた設計